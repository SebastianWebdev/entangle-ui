---
title: ChatPanel
description: Complete chat interface system for AI assistant integration with messages, input, tool calls, code blocks, and attachments.
---

import PropsTable from '../../../../components/PropsTable.astro';
import ComponentPreview from '../../../../components/ComponentPreview.astro';
import ChatPanelDemo from '../../../../components/demos/editor/ChatPanelDemo';

A comprehensive chat interface system designed for AI assistant integration in editor applications. ChatPanel is the layout container, and the module exports a full suite of components for building rich conversational UIs: message lists, chat bubbles, input with attachments, typing indicators, tool call displays, code blocks, and empty states. Also includes hooks for managing message state, input behavior, and auto-scroll.

<ComponentPreview title="Live Preview">
  <ChatPanelDemo client:visible />
</ComponentPreview>

## Import

```tsx
import {
  ChatPanel,
  ChatMessageList,
  ChatMessage,
  ChatBubble,
  ChatInput,
  ChatTypingIndicator,
  ChatToolCall,
  ChatCodeBlock,
  ChatAttachmentChip,
  ChatContextChip,
  ChatEmptyState,
  ChatActionBar,
  ChatInputToolbar,
  useChatMessages,
  useChatInput,
  useChatScroll,
} from 'entangle-ui';
```

## Usage

```tsx
const { messages, appendMessage, updateMessage } = useChatMessages();

<ChatPanel density="comfortable">
  <ChatMessageList
    messages={messages}
    emptyState={
      <ChatEmptyState
        title="How can I help?"
        description="Ask me anything about your scene."
        suggestions={['Create a cube', 'Change material', 'Add lighting']}
        onSuggestionClick={s => handleSend(s)}
      />
    }
  />
  <ChatInput
    onSubmit={value => handleSend(value)}
    placeholder="Ask the assistant..."
    streaming={isStreaming}
    onStop={handleStop}
  />
</ChatPanel>;
```

## Components

### ChatPanel

The root layout container that controls spacing density. Wrap all other chat components inside it.

```tsx
<ChatPanel density="comfortable">
  {/* ChatMessageList, ChatInput, etc. */}
</ChatPanel>
```

| Density       | Description                                                          |
| ------------- | -------------------------------------------------------------------- |
| `comfortable` | More spacing and larger bubbles. Use for side panels and fullscreen. |
| `compact`     | Tight spacing. Use for bottom panels and constrained areas.          |

### ChatMessageList

Renders an array of messages with auto-scroll behavior. Accepts a custom `renderMessage` function for full control over individual message rendering.

```tsx
<ChatMessageList
  messages={messages}
  autoScroll={true}
  emptyState={<ChatEmptyState title="No messages yet" />}
  renderMessage={(message, index) => (
    <ChatMessage key={message.id} message={message} showTimestamp showAvatar />
  )}
/>
```

### ChatMessage

Renders a single message with avatar, timestamp, and action buttons. Supports a custom content renderer for markdown, LaTeX, or other rich formats.

```tsx
<ChatMessage
  message={message}
  showTimestamp
  showAvatar
  actions={
    <ChatActionBar>
      <button onClick={handleCopy}>Copy</button>
      <button onClick={handleRetry}>Retry</button>
    </ChatActionBar>
  }
  renderContent={content => <MarkdownRenderer>{content}</MarkdownRenderer>}
/>
```

### ChatBubble

Low-level bubble component with role-based alignment and coloring. Use for custom message layouts.

```tsx
<ChatBubble role="user">Hello, can you help?</ChatBubble>
<ChatBubble role="assistant">Of course! What do you need?</ChatBubble>
<ChatBubble role="system">Session started</ChatBubble>
```

### ChatInput

Multi-line input with submit/stop button, attachment chips, and configurable submit key. Auto-resizes from 1 line up to `maxLines`.

```tsx
<ChatInput
  value={input}
  onChange={setInput}
  onSubmit={handleSubmit}
  onStop={handleStop}
  streaming={isStreaming}
  placeholder="Type a message..."
  submitKey="enter"
  maxLines={6}
  attachments={attachments}
  onRemoveAttachment={handleRemoveAttachment}
  toolbar={
    <ChatInputToolbar>
      <button onClick={handleUpload}>Attach File</button>
    </ChatInputToolbar>
  }
/>
```

### ChatTypingIndicator

Animated indicator shown while the assistant is generating a response.

```tsx
<ChatTypingIndicator visible={isStreaming} label="Thinking..." variant="dots" />
```

### ChatToolCall

Displays a tool/function invocation with expandable input/output details.

```tsx
<ChatToolCall
  toolCall={{
    id: '1',
    name: 'create_cube',
    status: 'completed',
    input: { size: 2 },
    output: { nodeId: 'cube_01' },
    durationMs: 120,
  }}
  collapsible
  defaultExpanded={false}
/>
```

### ChatCodeBlock

Code display with optional syntax highlighting, line numbers, copy button, and custom action buttons.

```tsx
<ChatCodeBlock
  code={`const mesh = new THREE.Mesh(geometry, material);`}
  language="typescript"
  copyable
  lineNumbers
  maxHeight={400}
  actions={<button onClick={handleInsert}>Insert</button>}
/>
```

### ChatAttachmentChip

Displays an attached file, image, code snippet, or selection as a chip.

```tsx
<ChatAttachmentChip
  attachment={{ id: '1', name: 'scene.glb', type: 'file', size: 1024000 }}
  removable
  onRemove={id => handleRemove(id)}
  onClick={attachment => handlePreview(attachment)}
/>
```

### ChatContextChip

Displays editor context (e.g., selected objects, active file) as a labeled chip.

```tsx
<ChatContextChip
  label="Selected"
  items={['Cube', 'Sphere', 'Light']}
  icon={<SelectionIcon />}
  onDismiss={handleDismiss}
/>
```

### ChatEmptyState

Shown when the message list is empty. Includes optional suggestion chips.

```tsx
<ChatEmptyState
  title="Start a conversation"
  description="Ask me to modify your scene, generate code, or explain concepts."
  suggestions={['Add a spotlight', 'Optimize materials', 'Export scene']}
  onSuggestionClick={suggestion => handleSend(suggestion)}
/>
```

### ChatActionBar

Horizontal row of action buttons shown below a message.

```tsx
<ChatActionBar>
  <button>Copy</button>
  <button>Retry</button>
  <button>Apply to Scene</button>
</ChatActionBar>
```

### ChatInputToolbar

Horizontal row of action buttons rendered below the chat input area.

```tsx
<ChatInputToolbar>
  <button>Attach File</button>
  <button>Add Context</button>
</ChatInputToolbar>
```

## Hooks

### useChatMessages

Manages the chat message array state with convenience methods.

```tsx
const {
  messages,
  setMessages,
  appendMessage,
  updateMessage,
  removeMessage,
  clearMessages,
  getMessage,
} = useChatMessages({
  initialMessages: [],
  maxMessages: 200,
});
```

### useChatInput

Manages textarea input state with auto-resize and submit key handling.

```tsx
const { value, setValue, clear, textareaRef, handleKeyDown, handleChange } =
  useChatInput({
    submitKey: 'enter',
    maxLines: 6,
    onSubmit: value => handleSend(value),
  });
```

### useChatScroll

Manages auto-scroll behavior for the message list, pausing when the user scrolls up.

```tsx
const { scrollContainerRef, isAtBottom, hasNewMessages, scrollToBottom } =
  useChatScroll({
    messages,
    enabled: true,
    threshold: 100,
  });
```

## Props

### ChatPanel

<PropsTable
  props={[
    {
      name: 'density',
      type: "'comfortable' | 'compact'",
      default: "'comfortable'",
      description:
        'Visual density of the chat layout. Comfortable has more spacing for side panels; compact is for constrained areas.',
    },
    {
      name: 'children',
      type: 'ReactNode',
      required: true,
      description: 'Panel content, typically ChatMessageList and ChatInput.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
    {
      name: 'ref',
      type: 'Ref<HTMLDivElement>',
      description: 'Ref to the root element.',
    },
  ]}
/>

### ChatMessageList

<PropsTable
  props={[
    {
      name: 'messages',
      type: 'ChatMessageData[]',
      required: true,
      description: 'Array of messages to render.',
    },
    {
      name: 'renderMessage',
      type: '(message: ChatMessageData, index: number) => ReactNode',
      description: 'Custom renderer for individual messages.',
    },
    {
      name: 'emptyState',
      type: 'ReactNode',
      description: 'Content shown when the messages array is empty.',
    },
    {
      name: 'autoScroll',
      type: 'boolean',
      default: 'true',
      description:
        'Auto-scroll to bottom on new messages. Pauses when user scrolls up, resumes at bottom.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatMessage

<PropsTable
  props={[
    {
      name: 'message',
      type: 'ChatMessageData',
      required: true,
      description: 'Message data object.',
    },
    {
      name: 'showTimestamp',
      type: 'boolean',
      description: 'Show timestamp below the message content.',
    },
    {
      name: 'showAvatar',
      type: 'boolean',
      description: 'Show avatar next to the message.',
    },
    {
      name: 'actions',
      type: 'ReactNode',
      description:
        'Action buttons rendered below the message (typically a ChatActionBar).',
    },
    {
      name: 'renderContent',
      type: '(content: string) => ReactNode',
      description:
        'Custom content renderer for markdown, LaTeX, or other rich formats.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatInput

<PropsTable
  props={[
    {
      name: 'value',
      type: 'string',
      description: 'Current input value (controlled).',
    },
    {
      name: 'onChange',
      type: '(value: string) => void',
      description: 'Change handler for controlled usage.',
    },
    {
      name: 'onSubmit',
      type: '(value: string, attachments: ChatAttachmentData[]) => void',
      description: 'Called when the user submits the message.',
    },
    {
      name: 'onStop',
      type: '() => void',
      description: 'Called when the user clicks the stop generation button.',
    },
    {
      name: 'placeholder',
      type: 'string',
      description: 'Placeholder text for the input.',
    },
    {
      name: 'streaming',
      type: 'boolean',
      default: 'false',
      description:
        'Whether the assistant is currently streaming. Shows stop button instead of send.',
    },
    { name: 'disabled', type: 'boolean', description: 'Disable the input.' },
    {
      name: 'submitKey',
      type: "'enter' | 'ctrl+enter'",
      default: "'enter'",
      description:
        'Key combination that submits the message. The other combination inserts a newline.',
    },
    {
      name: 'maxLines',
      type: 'number',
      default: '6',
      description: 'Maximum visible lines before the input scrolls.',
    },
    {
      name: 'attachments',
      type: 'ChatAttachmentData[]',
      description: 'Currently attached items shown as chips above the input.',
    },
    {
      name: 'onRemoveAttachment',
      type: '(attachmentId: string) => void',
      description: 'Called when user removes an attachment chip.',
    },
    {
      name: 'prefix',
      type: 'ReactNode',
      description:
        'Content rendered before the textarea (e.g., context chips).',
    },
    {
      name: 'suffix',
      type: 'ReactNode',
      description:
        'Content rendered after the textarea (e.g., additional action buttons).',
    },
    {
      name: 'toolbar',
      type: 'ReactNode',
      description:
        'Toolbar rendered below the input area (use ChatInputToolbar as the wrapper).',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatTypingIndicator

<PropsTable
  props={[
    {
      name: 'label',
      type: 'string',
      default: "'Thinking...'",
      description: 'Label shown alongside the animation.',
    },
    {
      name: 'variant',
      type: "'dots' | 'pulse'",
      default: "'dots'",
      description: 'Animation style: three animated dots or a pulsing bar.',
    },
    {
      name: 'visible',
      type: 'boolean',
      description: 'Whether the indicator is visible.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatToolCall

<PropsTable
  props={[
    {
      name: 'toolCall',
      type: 'ChatToolCallData',
      required: true,
      description:
        'Tool call data object with id, name, status, input, output, error, and duration.',
    },
    {
      name: 'collapsible',
      type: 'boolean',
      default: 'true',
      description: 'Whether the input/output details can be expanded.',
    },
    {
      name: 'defaultExpanded',
      type: 'boolean',
      default: 'false',
      description: 'Whether details are initially expanded.',
    },
    {
      name: 'icon',
      type: 'ReactNode',
      description: 'Custom icon for the tool (defaults to a wrench icon).',
    },
    {
      name: 'renderOutput',
      type: '(output: Record<string, unknown>) => ReactNode',
      description: 'Custom renderer for the tool output.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatCodeBlock

<PropsTable
  props={[
    {
      name: 'code',
      type: 'string',
      required: true,
      description: 'Code content to display.',
    },
    {
      name: 'language',
      type: 'string',
      description: 'Programming language for syntax highlighting.',
    },
    {
      name: 'copyable',
      type: 'boolean',
      default: 'true',
      description: 'Show a copy-to-clipboard button.',
    },
    {
      name: 'lineNumbers',
      type: 'boolean',
      default: 'false',
      description: 'Show line numbers.',
    },
    {
      name: 'maxHeight',
      type: 'number',
      default: '400',
      description: 'Maximum visible height in pixels before the block scrolls.',
    },
    {
      name: 'actions',
      type: 'ReactNode',
      description:
        'Actions rendered in the code block header alongside the copy button.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatAttachmentChip

<PropsTable
  props={[
    {
      name: 'attachment',
      type: 'ChatAttachmentData',
      required: true,
      description: 'Attachment data object.',
    },
    {
      name: 'onRemove',
      type: '(id: string) => void',
      description: 'Called when the remove button is clicked.',
    },
    {
      name: 'onClick',
      type: '(attachment: ChatAttachmentData) => void',
      description: 'Called when the chip itself is clicked (e.g., to preview).',
    },
    {
      name: 'removable',
      type: 'boolean',
      default: 'false',
      description: 'Whether to show the remove button.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatContextChip

<PropsTable
  props={[
    {
      name: 'label',
      type: 'string',
      required: true,
      description:
        'Label describing the context (e.g., "Selected", "Active file").',
    },
    {
      name: 'items',
      type: 'string[]',
      required: true,
      description: 'Items in this context group.',
    },
    {
      name: 'icon',
      type: 'ReactNode',
      description: 'Icon shown before the label.',
    },
    {
      name: 'onDismiss',
      type: '() => void',
      description: 'Called when the chip is dismissed.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

### ChatEmptyState

<PropsTable
  props={[
    { name: 'title', type: 'string', description: 'Main heading text.' },
    {
      name: 'description',
      type: 'string',
      description: 'Supporting description text.',
    },
    { name: 'icon', type: 'ReactNode', description: 'Icon or illustration.' },
    {
      name: 'suggestions',
      type: 'string[]',
      description:
        'Quick-start suggestion chips that populate the input when clicked.',
    },
    {
      name: 'onSuggestionClick',
      type: '(suggestion: string) => void',
      description: 'Called when a suggestion chip is clicked.',
    },
    {
      name: 'className',
      type: 'string',
      description: 'Additional CSS class names.',
    },
    { name: 'style', type: 'CSSProperties', description: 'Inline styles.' },
    {
      name: 'testId',
      type: 'string',
      description: 'Test identifier for automated testing.',
    },
  ]}
/>

## Data Types

### ChatMessageData

```tsx
interface ChatMessageData {
  id: string;
  role: 'user' | 'assistant' | 'system' | 'tool';
  content: string;
  status: 'complete' | 'streaming' | 'error' | 'pending';
  timestamp: string; // ISO 8601
  attachments?: ChatAttachmentData[];
  toolCalls?: ChatToolCallData[];
  avatar?: string;
  displayName?: string;
}
```

### ChatAttachmentData

```tsx
interface ChatAttachmentData {
  id: string;
  name: string;
  type: 'file' | 'image' | 'code' | 'selection';
  mimeType?: string;
  size?: number;
  thumbnailUrl?: string;
  content?: string;
  meta?: Record<string, unknown>;
}
```

### ChatToolCallData

```tsx
interface ChatToolCallData {
  id: string;
  name: string;
  status: 'pending' | 'running' | 'completed' | 'error';
  input?: Record<string, unknown>;
  output?: Record<string, unknown>;
  error?: string;
  durationMs?: number;
}
```
